{"version":3,"sources":["src-shared/HeadphoneCheck_Test/headphonesCheck.js"],"names":["HeadphonesCheck","settings","_settings","callback","undefined","volumeSound","volumeText","checkType","checkVolume","checkExample","checkSounds","answer","file","trialCount","passMark","maxAttempts","htmlElements","huggins","instruction","checkPage","beat","antiphase","reattempt","audioProblem","Object","assign","toLowerCase","isHeadphones","attemptCount","attemptRecord","stylesheet","document","createElement","innerText","_stylesheet","head","appendChild","resolveCall","_promise","Promise","resolve","_adjustVolume","then","repeat","console","log","_checkVolume","promise","$","button","_instruction","fulfilled","rejectCall","reject","html","_createDialog","content","title","yes","_createPlayer","back","_performCheck","checkHeadphones","color","css","_trialHandler","_offerReattempt","remaining","current","empty","_currentRecord","trials","numberCorrect","_stimuli","_shuffle","index","trigger","dialog","progressbar","max","value","children","length","trialData","_createTrial","response","push","correct","soundFile","audioSelector","audioCount","on","prop","audioElements","dataset","headphonesAudioGroup","addClass","removeClass","attr","audio","volume","headphonesVolume","play","selector","off","paused","ended","pause","array","i","j","Math","floor","random","options","defaults","resizeToFit","my","at","of","window","maxHeight","documentElement","clientHeight","outerHeight","append","dialogOptions","width","height","classes","modal","resizable","draggable","closeOnEscape","buttons","open","close","remove","text","click","prev"],"mappings":"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","file":"headphonesCheck.ad820d03.js","sourceRoot":"..","sourcesContent":["/**\n * Sijia Zhao (2020-2021) sijia.zhao@psy.ox.ac.uk\n * Read LICENSE file before using\n */\n\nclass HeadphonesCheck {\n\n  /**\n   * Stylesheet\n   */\n  _stylesheet = '@charset \"utf-8\";' +\n      '.no-close .ui-dialog-titlebar-close {' +\n      '  display: none;' +\n      '}' +\n      '#headphones-dialog {' +\n      '  text-align: justify;' +\n      '}' +\n      '#headphones-dialog .center {' +\n      '  text-align: center;' +\n      '}' +\n      '#headphones-dialog table {' +\n      '  margin: 2em auto;' +\n      '}' +\n      '#headphones-dialog table,' +\n      '#headphones-dialog table td {' +\n      '  border: none;' +\n      '  vertical-align: text-top;' +\n      '}' +\n      '#headphones-dialog td {' +\n      '  padding: 0.5em;' +\n      '}' +\n      '#headphones-dialog .notice {' +\n      '  text-align: center;' +\n      '  font-weight: bold;' +\n      '  margin: 2em 0;' +\n      '}' +\n      '#headphones-dialog .left {' +\n      '  text-align: left !important;' +\n      '}' +\n      '#headphones-dialog hr {' +\n      '  border: none;' +\n      '  border-top: 1px solid #ddd;' +\n      '  margin: 1em auto;' +\n      '}' +\n      'button[data-helper-button] {' +\n      '  width: 60px;' +\n      '  height: 60px;' +\n      '  border: 1px solid #c5c5c5;' +\n      '  border-radius: 10px;' +\n      '  background-color: #f6f6f6;' +\n      '  margin: 0.5em;' +\n      '  padding: 15px 0;' +\n      '  text-align: center;' +\n      '  cursor: pointer;' +\n      '  color: #000;' +\n      '}' +\n      'button[data-headphones-audio-control] {' +\n      '  border: 1px solid #03a9f4;' +\n      '}' +\n      'button[data-headphones-check-next] {' +\n      '  width: auto;' +\n      '  padding: 1em;' +\n      '}' +\n      '#headphones-dialog [data-headphones-check-target] {' +\n      '  height: 10em;' +\n      '}' +\n      '#headphones-dialog table {' +\n      '  margin-bottom: 3em;' +\n      '}' +\n      '#headphones-dialog td {' +\n      '  width: 16em;' +\n      '}' +\n      '#headphones-dialog td span {' +\n      '  font-weight: normal;' +\n      '  display: block;' +\n      '  margin-bottom: 1em;' +\n      '}' +\n      '#headphones-dialog td span.disabled {' +\n      '  color: #c5c5c5;' +\n      '}' +\n      '#headphones-dialog [data-headphones-progress] {' +\n      '  position: relative;' +\n      '}' +\n      '#headphones-dialog [data-headphones-progress] span {' +\n      '  display: block;' +\n      '  width: 100%;' +\n      '  padding: 0.5em;' +\n      '  position: absolute;' +\n      '  text-align: center;' +\n      '}' +\n      'button[data-helper-button]:hover {' +\n      '  background-color: #f0f0f0;' +\n      '}' +\n      'button[data-helper-button]:active {' +\n      '  background-color: #eaeaea;' +\n      '  border-width: 2px;' +\n      '}' +\n      'button[data-helper-button][disabled],' +\n      'button[data-helper-button][disabled]:hover,' +\n      'button[data-helper-button][disabled]:active {' +\n      '  background-color: #f6f6f6;' +\n      '  border: 1px solid #c5c5c5;' +\n      '  width: auto;' +\n      '  padding: 1em;' +\n      '  cursor: initial;' +\n      '  color: #c5c5c5;' +\n      '}' +\n      'button[data-headphones-check-response][disabled],' +\n      'button[data-headphones-check-response][disabled]:hover,' +\n      'button[data-headphones-check-response][disabled]:active {' +\n      '  width: 60px;' +\n      '}' +\n      'button[data-helper-button=\\'selected\\'] {' +\n      '  border-color: #32CD32;' +\n      '  background-color: #bbf8bb;' +\n      '  font-weight: bold;' +\n      '}' +\n      'button[data-helper-button=\\'selected\\']:hover {' +\n      '  background-color: #b5f2b5;' +\n      '}' +\n      'button[data-helper-button=\\'selected\\']:active {' +\n      '  background-color: #afecaf;' +\n      '  border-width: 2px;' +\n      '}' +\n      'button[data-helper-button][disabled] img {' +\n      '  display: none;' +\n      '}' +\n      'button[data-helper-button] img {' +\n      '  height: 30px;' +\n      '}';\n\n  /**\n   * Constructor\n   *\n   * @constructor\n   * @param {object} [settings={}] - settings for the Headphones Check\n   * @param {Function} [settings.callback] - optional callback function on completion\n   * @param {string} [settings.volumeSound] - sound for volume adjustment\n   * @param {string} [settings.volumeText] - override text to shown volume adjustment page\n   * @param {string} [settings.checkType=huggins] - headphones check paradigm,`huggins` or `antiphase`, or `beat`\n   * @param {int} [settings.checkVolume=1] - volume setting for check sounds, from `0` (quietest) to `1` (loudest)\n   * @param {string} [settings.checkExample] - example check sound (`huggins` and `beat` checkType only)\n   * @param {object[]} [settings.checkSounds] - sounds for headphones check. `object` format: `{answer: int, file: string}`\n   * @param {int} [settings.trialCount=6] - number of headphones check trials\n   * @param {int} [settings.passMark=6] - number of correct trials to pass the check\n   * @param {int} [settings.maxAttempts=2] - max number of attempts\n   */\n  constructor(settings = {}) {\n    this._settings = {\n      callback: undefined,\n      volumeSound: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_calibration.flac',\n      volumeText: '<p class=\"notice\">Please put on your headphones.</p>' +\n          '<p>If you do not have headphones, you can use earbuds (headphones are preferred).</p>' +\n          '<p>Click the <span style=\"color:#03a9f4;\"><b>blue</b></span> button below to play a sound to check your volume.</p>',\n      checkType: 'huggins',\n      checkVolume: 1,\n      checkExample: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_example_2.flac',\n      checkSounds: [\n        {answer: 1, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set1_1.flac'},\n        {answer: 2, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set1_2.flac'},\n        {answer: 3, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set1_3.flac'},\n        {answer: 1, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set2_1.flac'},\n        {answer: 2, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set2_2.flac'},\n        {answer: 3, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set2_3.flac'},\n        {answer: 1, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set3_1.flac'},\n        {answer: 2, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set3_2.flac'},\n        {answer: 3, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set3_3.flac'},\n        {answer: 1, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set4_1.flac'},\n        {answer: 2, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set4_2.flac'},\n        {answer: 3, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set4_3.flac'},\n        {answer: 1, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set5_1.flac'},\n        {answer: 2, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set5_2.flac'},\n        {answer: 3, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set5_3.flac'},\n        {answer: 1, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set6_1.flac'},\n        {answer: 2, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set6_2.flac'},\n        {answer: 3, file: 'src-shared/HeadphoneCheck_Test/stimuli_HugginsPitch/HugginsPitch_set6_3.flac'},\n      ],\n      trialCount: 6,\n      passMark: 6,\n      maxAttempts: 2,\n    };\n    this.htmlElements = {\n      huggins: {\n        instruction: '<p class=\"notice\">Now we will check your headphones.</p>' +\n            '<p>We need to make sure that your headphones are adjusted and are functioning correctly.</p>' +\n            '<p>On the next few pages, each page will have a button that plays a sound. You can only play each sound once, so don\\'t press the button until you are ready.</p>' +\n            '<p>Each sound contains three noises with silent gaps in-between. One of the noises has a faint beep hidden within.</p>' +\n            '<p>Your task is to decide which of the three noises contains the beep, and click on the correct button: <b>1</b>, <b>2</b>, or <b>3</b>.</p>' +\n            '<p>Click the <span style=\"color:#03a9f4;\"><b>blue</b></span> button below to play an example. The beep is hidden inside the second noise, so the answer is <b>2</b>.' +\n            '    You can play the example as many times as you like.</p>' +\n            '<div class=\"notice\"><button type=\"button\" data-helper-button data-headphones-audio-control data-headphones-audio-group=\"group1\" disabled>Loading sounds...</button></div>' +\n            '<span data-headphones-check-target></span>',\n        checkPage: '<p class=\"notice\">Remember, you can only play each sound once. Please listen carefully.</p>' +\n            '<p class=\"center\">Which noise contains the hidden beep? Is it <b>1</b>, <b>2</b>, or <b>3</b>?</p>',\n      },\n      beat: {\n        instruction: '<p class=\"notice\">Now we will check your headphones.</p>' +\n            '<p>We need to make sure that your headphones are adjusted and are functioning correctly.</p>' +\n            '<p>On the next few pages, each page will have a button that plays a sound. You can only play each sound once, so don\\'t press the button until you are ready.</p>' +\n            '<p>Each sound contains three noises with silent gaps in-between.</p>' +\n            '<p>Your task is to decide which of the three noises was smoothest, and click on the correct button: <b>1</b>, <b>2</b>, or <b>3</b>.</p>' +\n            '<p>Click the <span style=\"color:#03a9f4;\"><b>blue</b></span> button below to play an example. The smoothest tone is the second noise, so the answer is <b>2</b>.' +\n            '    You can play the example as many times as you like.</p>' +\n            '<div class=\"notice\"><button type=\"button\" data-helper-button data-headphones-audio-control data-headphones-audio-group=\"group1\" disabled>Loading sounds...</button></div>' +\n            '<span data-headphones-check-target></span>',\n        checkPage: '<p class=\"notice\">Remember, you can only play each sound once. Please listen carefully.</p>' +\n            '<p class=\"center\">Which noise is the smoothest? Is it <b>1</b>, <b>2</b>, or <b>3</b>?</p>',\n      },\n      antiphase: {\n        instruction: '<p class=\"notice\">Now we will check your headphones.</p>' +\n            '<p>We need to make sure that your headphones are adjusted and are functioning correctly.</p>' +\n            '<p>On the next few pages, each page will have a button that plays a sound. You can only play each sound once, so don\\'t press the button until you are ready.</p>' +\n            '<p>Each sound contains three noises with silent gaps in-between.</p>' +\n            '<p>Your task is to decide which of the three noises was quietest or softest, and click on the correct button: <b>1</b>, <b>2</b>, or <b>3</b>.</p>',\n        checkPage: '<p class=\"notice\">Remember, you can only play each sound once. Please listen carefully.</p>' +\n            '<p class=\"center\">Which noise is the quietest or softest? Is it <b>1</b>, <b>2</b>, or <b>3</b>?</p>',\n      },\n      reattempt: '<p class=\"notice\">Unfortunately, you did not pass the headphones check.</p>' +\n          '<p>Please make sure that you are in a quiet room, and that you are wearing your headphones correctly.</p>' +\n          '<p>You may also try using a different pair of headphones. It is possible that the sound quality of the headphones was not good enough.</p>' +\n          '<p class=\"notice\">If you are sure that your headphones are working properly, you can try the headphones check again.</p>',\n      audioProblem: '<p>Your browser cannot play the audio files used in this study.<br>This study will not work.</p>' +\n          '<p>Please try again using a different web browser (Firefox and Chrome are recommended), and update your web browser to its newest version.</p>',\n    };\n    if (settings) {\n      this._settings = Object.assign(this._settings, settings);\n      this.callback = (typeof this._settings.callback === 'function') ? this._settings.callback : function() {};\n      if (this._settings.checkVolume > 1) {\n        this._settings.checkVolume = 1;\n      } else {\n        if (this._settings.checkVolume < 0) {\n          this._settings.checkVolume = 0;\n        }\n      }\n      if (settings.checkType) {\n        switch (settings.checkType.toLowerCase()) {\n          case 'antiphase':\n            this._settings.checkType = 'antiphase';\n            break;\n          case 'beat':\n            this._settings.checkType = 'beat';\n            break;\n          case 'huggins':\n          default:\n            this._settings.checkType = 'huggins';\n        }\n      }\n      if (this._settings.passMark > this._settings.trialCount) {\n        this._settings.passMark = this._settings.trialCount;\n      }\n    }\n    this.isHeadphones = undefined;\n    this.attemptCount = 0;\n    this.attemptRecord = {};\n    const stylesheet = document.createElement('style');\n    stylesheet.innerText = this._stylesheet;\n    document.head.appendChild(stylesheet);\n  }\n\n  /**\n   * Perform a volume check\n   *\n   * @member HeadphonesCheck.checkVolume\n   * @param {Function} [callback] - (if set) callback on completion\n   * @returns {Promise} resolved on completion\n   */\n  checkVolume(callback) {\n    if (typeof callback === 'function') {\n      this.callback = callback;\n    }\n    let resolveCall;\n    this._promise = new Promise(resolve => resolveCall = resolve);\n    this._promise.resolve = resolveCall;\n    this._adjustVolume().then(() => {\n      this._promise.resolve();\n      this.callback();\n    });\n    return this._promise;\n  }\n\n  /**\n   * Perform a headphones check (including a volume check)\n   *\n   * @member HeadphonesCheck.checkHeadphones\n   * @param {Function} [callback] - (if set) callback on completion, with the result as argument: `true` or `false`\n   * @param {boolean} [checkVolume=true] - whether to perform a volume check before the headphones check\n   * @param {boolean} [repeat] - indicates if user has returned to the checkVolume page, so enable the \"I have finished...\" button\n   * @returns {Promise} fulfilled with the result of the headphones check (pass: resolve, fail: reject)\n   */\n  checkHeadphones(callback, checkVolume = true, repeat) {\n    console.log('checkheadphones')\n    if (typeof callback === 'function') {\n      this.callback = callback;\n    }\n    this._checkVolume = checkVolume;\n    console.log(checkVolume)\n    if (this._checkVolume) {\n      const promise = this._adjustVolume();\n      if (repeat) {\n        $('button:contains(\"finished\")').button('option', 'disabled', false);\n      }\n      promise.then(() => {\n        this._instruction();\n      });\n    } else {\n      this._instruction();\n    }\n    if (!this._promise || this._promise.fulfilled === true) {\n      let resolveCall, rejectCall;\n      this._promise = new Promise((resolve, reject) => {\n        resolveCall = resolve;\n        rejectCall = reject;\n      });\n      this._promise.resolve = resolveCall;\n      this._promise.reject = rejectCall;\n    }\n    return this._promise;\n  }\n\n  /**\n   * Volume adjustment page\n   * @private\n   * @member HeadphonesCheck._adjustVolume\n   * @return {Promise}\n   */\n  _adjustVolume() {\n    const html = this._settings.volumeText +\n        '<div class=\"notice\">' +\n        '<button type=\"button\" data-helper-button data-headphones-audio-control data-headphones-audio-group=\"group1\" disabled>Loading sounds...</button>' +\n        '<audio data-headphones-audio-group=\"group1\" data-headphones-volume=\"1\" preload=\"auto\" loop><source src=\"' + this._settings.volumeSound + '\">' + this.htmlElements.audioProblem + '</audio>' +\n        '</div>' +\n        '<p>If you do not adjust your volume correctly, you will not be able to successfully complete the study, and the study may stop before completion.</p>';\n    const promise = this._createDialog({content: html, title: 'Adjust your sound volume', yes: 'I have finished adjusting my sound volume'});\n    this._createPlayer('button:contains(\"finished\")');\n    return promise;\n  }\n\n  /**\n   * Instructions page\n   * @private\n   * @member HeadphonesCheck._instruction\n   */\n  _instruction() {\n    let html = this.htmlElements[this._settings.checkType].instruction +\n        '<p class=\"notice\">Remember, from now on, you can only play each sound once.<br>Please listen carefully and choose your answer.</p>' +\n        '<p class=\"notice\">Are you ready?</p>';\n    const promise = this._createDialog({content: html, title: 'Headphones check', yes: 'I am ready to begin', back: 'Back'});\n    if (this._settings.checkType === 'huggins' || this._settings.checkType === 'beat') {\n      $('span[data-headphones-check-target]').html(\n          '<audio data-headphones-audio-group=\"group1\" data-headphones-volume=\"' + this._settings.checkVolume + '\" preload=\"auto\"><source src=\"' + this._settings.checkExample + '\">' + this.htmlElements.audioProblem + '</audio>',\n      );\n      this._createPlayer('button:contains(\"ready\")');\n    }\n    promise.then(\n        () => {\n          this._performCheck();\n        },\n        () => {\n          void this.checkHeadphones(undefined, this._checkVolume, true);\n        },\n    );\n  }\n\n  /**\n   * Offer another attempt, if allowed by settings\n   * @private\n   * @member HeadphonesCheck._offerReattempt\n   */\n  _offerReattempt() {\n    let html = this.htmlElements.reattempt;\n    if (+this.attemptCount === this._settings.maxAttempts - 1) {\n      html += '<p class=\"notice\">If you do not pass on your next attempt, the study cannot continue.</p>';\n    }\n    this._createDialog({content: html, title: 'Headphones check failed', yes: 'Try again', color: '#FFA500'})\n        .then(() => {\n          this._instruction();\n        });\n  }\n\n  /**\n   * Perform the headphones check\n   * @private\n   * @member HeadphonesCheck._performCheck\n   */\n  _performCheck() {\n    let html = this.htmlElements[this._settings.checkType].checkPage +\n        '<div class=\"center\" data-headphones-check-target></div>' +\n        '<hr><div data-headphones-progress><span></span></div>';\n    const promise = this._createDialog({content: html, title: 'Headphones check', yes: 'Continue'});\n    $('button:contains(\"Continue\")')\n        .button('option', 'disabled', true)\n        .css('visibility', 'hidden');\n    this._trialHandler(this._settings.trialCount);\n    promise.then(() => {\n      if (this.isHeadphones) {\n        this._promise.resolve();\n        this._promise.fulfilled = true;\n        this.callback(true);\n      } else {\n        if (this.attemptCount < this._settings.maxAttempts) {\n          this._offerReattempt();\n        } else {\n          this._promise.reject();\n          this._promise.fulfilled = true;\n          this.callback(false);\n        }\n      }\n    });\n  }\n\n  /**\n   * Display individual headphones check trials\n   * @private\n   * @member HeadphonesCheck._trialHandler\n   * @param {int} remaining\n   * @param {int} current\n   */\n  _trialHandler(remaining, current = 0) {\n\n    $('[data-headphones-check-target]').empty();\n    if (!current) {\n      current = 1;\n      this.attemptCount++;\n      this._currentRecord = {};\n      this._currentRecord.trials = [];\n      this._currentRecord.numberCorrect = 0;\n      this._stimuli = this._shuffle([...this._settings.checkSounds]);\n      this._stimuli.index = 0;\n    }\n    if (remaining <= 0) {\n      this._currentRecord.isHeadphones = (this._currentRecord.numberCorrect >= this._settings.passMark);\n      this.isHeadphones = this._currentRecord.isHeadphones;\n      this.attemptRecord[this.attemptCount] = this._currentRecord;\n      $('button:contains(\"Continue\")')\n          .button('option', 'disabled', false)\n          .css('visibility', 'visible')\n          .trigger('click');\n      return;\n    }\n    $('#headphones-dialog').dialog('option', 'title', 'Headphones check (' + current + ' of ' + this._settings.trialCount + ')');\n    $('[data-headphones-progress]')\n        .progressbar({max: this._settings.trialCount, value: current})\n        .children('span').html('Progress: ' + current + '/' + this._settings.trialCount);\n    if (current > this._stimuli.length) {\n      this._shuffle(this._stimuli);\n      this._stimuli.index = 0;\n    }\n    const trialData = this._stimuli[this._stimuli.index++];\n    console.log('createTrial')\n    this._createTrial(trialData.file)\n        .then((response) => {\n          if (+response === trialData.answer) {\n            this._currentRecord.numberCorrect++;\n          }\n          this._currentRecord.trials.push({\n            answer: trialData.answer,\n            file: trialData.file,\n            response: response,\n            correct: +response === trialData.answer,\n          });\n          this._trialHandler(--remaining, ++current);\n        });\n  }\n\n  /**\n   * Creates individual headphones check trials\n   * @private\n   * @member HeadphonesCheck._createTrial\n   * @param {string} soundFile\n   * @return {Promise}\n   */\n  _createTrial(soundFile) {\n    console.log(soundFile)\n    let html = '<table><tr>' +\n        '<td>' +\n        '<span data-headphones-check-stage=\"1\">Listen to the sound</span>' +\n        '<button type=\"button\" data-helper-button data-headphones-audio-control data-headphones-audio-group=\"group1\" disabled>Loading sound...</button>' +\n        '</td>' +\n        '<td>' +\n        '<span class=\"disabled\" data-headphones-check-stage=\"2\">choose your answer</span>' +\n        '<button type=\"button\" data-headphones-check-response=\"1\" data-helper-button disabled>1</button>' +\n        '<button type=\"button\" data-headphones-check-response=\"2\" data-helper-button disabled>2</button>' +\n        '<button type=\"button\" data-headphones-check-response=\"3\" data-helper-button disabled>3</button>' +\n        '</td>' +\n        '<td>' +\n        '<span class=\"disabled\" data-headphones-check-stage=\"3\">and continue to the next sound</span>' +\n        '<button type=\"button\" data-helper-button data-headphones-check-next disabled>Confirm and continue</button>' +\n        '</td>' +\n        '</tr></table>' +\n        '<audio data-headphones-audio-group=\"group1\" data-headphones-volume=\"' + this._settings.checkVolume + '\" preload=\"auto\"><source src=\"' + soundFile + '\">' + this.htmlElements.audioProblem + '</audio>';\n    $('[data-headphones-check-target]').html(html);\n    const audioSelector = $('audio[data-headphones-audio-group]');\n    let audioCount = audioSelector.length;\n    return new Promise((resolve) => {\n      audioSelector.on('canplaythrough', () => {\n        if (--audioCount <= 0) {\n          $('button[data-headphones-audio-control]')\n              .html('<img alt=\"Play\" src=\"data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 31.7 31.9\\'%3E%3Cpath d=\\'M8.6,0.5C6.8-0.6,5.2,0.2,5.2,2.4v27c0,2.2,1.5,3.1,3.4,1.9L30.3,18c1.9-1.2,1.9-3,0-4.2L8.6,0.5z\\' fill=\\'%2303A9F4\\'/%3E%3C/svg%3E\">')\n              .prop('disabled', false)\n              .on('click', function() {\n                $(this)\n                    .prop('disabled', true)\n                    .html('Playing...');\n                const audioElements = $('audio[data-headphones-audio-group=' + this.dataset.headphonesAudioGroup + ']');\n                audioElements.on('ended', () => {\n                  $('button[data-headphones-audio-control]').html('Already played');\n                  $('span[data-headphones-check-stage]').addClass('disabled');\n                  $('span[data-headphones-check-stage=\"2\"]').removeClass('disabled');\n                  $('button[data-headphones-check-response]')\n                      .prop('disabled', false)\n                      .on('click', function() {\n                        $('span[data-headphones-check-stage=\"3\"]').removeClass('disabled');\n                        $('button[data-headphones-check-response]').attr('data-helper-button', '');\n                        $(this).attr('data-helper-button', 'selected');\n                        $('button:contains(\"continue\")')\n                            .prop('disabled', false)\n                            .on('click', () => {\n                              resolve(\n                                  $('button[data-headphones-check-response][data-helper-button=\"selected\"]')\n                                      .attr('data-headphones-check-response'),\n                              );\n                            });\n                      });\n                });\n                for (const audio of audioElements) {\n                  audio.volume = audio.dataset.headphonesVolume;\n                  audio.play();\n                }\n              });\n        }\n      });\n    });\n  }\n\n  /**\n   * Create audio player and disable `selector` button until played\n   * @private\n   * @member HeadphonesCheck._createPlayer\n   * @param {string} selector\n   */\n  _createPlayer(selector) {\n    if (selector) {\n      $(selector).button('option', 'disabled', true);\n    }\n    const audioSelector = $('audio[data-headphones-audio-group]');\n    let audioCount = audioSelector.length;\n    audioSelector\n        .on('canplaythrough', function() {\n          $(this).off('canplaythrough');\n          if (--audioCount <= 0) {\n            $('button[data-headphones-audio-control]')\n                .html('<img alt=\"Play\" src=\"data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 31.7 31.9\\'%3E%3Cpath d=\\'M8.6,0.5C6.8-0.6,5.2,0.2,5.2,2.4v27c0,2.2,1.5,3.1,3.4,1.9L30.3,18c1.9-1.2,1.9-3,0-4.2L8.6,0.5z\\' fill=\\'%2303A9F4\\'/%3E%3C/svg%3E\">')\n                .prop('disabled', false)\n                .on('click', function() {\n                  const audioElements = $('audio[data-headphones-audio-group=' + this.dataset.headphonesAudioGroup + ']');\n                  for (const audio of audioElements) {\n                    audio.volume = audio.dataset.headphonesVolume;\n                    if (audio.paused || audio.ended) {\n                      audio.play();\n                      $(this).css('border-color', '#f0f')\n                          .children('img').attr('src', 'data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 17.7 31.9\\'%3E%3Crect width=\\'6.2\\' height=\\'31.9\\' rx=\\'3.1\\' ry=\\'3.1\\' fill=\\'%23f0f\\'/%3E%3Crect x=\\'11.4\\' width=\\'6.2\\' height=\\'31.9\\' rx=\\'3.1\\' ry=\\'3.1\\' fill=\\'%23f0f\\'/%3E%3C/svg%3E').attr('alt', 'Pause');\n                      if (selector) {\n                        $(selector).button('option', 'disabled', false);\n                      }\n                    } else {\n                      audio.pause();\n                      $(this).css('border-color', '#03a9f4')\n                          .children('img').attr('src', 'data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 31.7 31.9\\'%3E%3Cpath d=\\'M8.6,0.5C6.8-0.6,5.2,0.2,5.2,2.4v27c0,2.2,1.5,3.1,3.4,1.9L30.3,18c1.9-1.2,1.9-3,0-4.2L8.6,0.5z\\' fill=\\'%2303A9F4\\'/%3E%3C/svg%3E').attr('alt', 'Play');\n                    }\n                  }\n                });\n          }\n        })\n        .on('ended', () => {\n          $('button[data-headphones-audio-control]')\n              .css('border-color', '#03a9f4')\n              .children('img').attr('src', 'data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 31.7 31.9\\'%3E%3Cpath d=\\'M8.6,0.5C6.8-0.6,5.2,0.2,5.2,2.4v27c0,2.2,1.5,3.1,3.4,1.9L30.3,18c1.9-1.2,1.9-3,0-4.2L8.6,0.5z\\' fill=\\'%2303A9F4\\'/%3E%3C/svg%3E').attr('alt', 'Play');\n        });\n  }\n\n  /**\n   * Shuffle an array\n   * @private\n   * @member HeadphonesCheck._shuffle\n   * @param {[]} [array=[]]\n   * @returns {[]}\n   */\n  _shuffle(array = []) {\n    for (let i = array.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [array[i], array[j]] = [array[j], array[i]];\n    }\n    return array;\n  }\n\n  /**\n   * Create a dialog with a `Promise` resolved/rejected by buttons, using JQueryUI\n   * @private\n   * @member HeadphonesCheck._createDialog\n   * @param {{}} options\n   * @param {string} [options.content=''] - dialog content\n   * @param {string} [options.title='Headphones check'] - dialog title\n   * @param {string} [options.color='#32CD32'] - title bar color\n   * @param {string|undefined} [options.back=undefined] - 'Back' button text, or `undefined` for no button\n   * @param {string|undefined} [options.yes=undefined] - 'Yes' button text, or `undefined` for no button\n   * @return {Promise} Promise - `resolve()` by 'Yes' button, `reject('back')` by 'Back' button\n   */\n  _createDialog(options = {}) {\n    const defaults = {\n      content: '',\n      title: 'Headphones check',\n      color: '#32CD32',\n    };\n    options = Object.assign(defaults, options);\n    return new Promise((resolve, reject) => {\n      function resizeToFit() {\n        dialog\n            .dialog('option', 'height', 'auto')\n            .dialog('option', 'position', {my: 'center', at: 'center', of: window});\n        const maxHeight = document.documentElement.clientHeight - 40;\n        if (dialog.outerHeight(true) > maxHeight) {\n          dialog.dialog('option', 'height', maxHeight);\n        }\n      }\n\n      $('body').append('<div id=\"headphones-dialog\" title=\"' + options.title + '\">' + options.content + '</div>');\n      const dialog = $('#headphones-dialog');\n      const dialogOptions = {\n        width: 1000,\n        height: 'auto',\n        classes: {'ui-dialog': 'no-close'},\n        modal: true,\n        resizable: false,\n        draggable: false,\n        closeOnEscape: false,\n        buttons: [],\n        open: resizeToFit,\n        close: function() {\n          $(window).off('resize', resizeToFit);\n          $(this).dialog('destroy').remove();\n        },\n      };\n      if (options.back) {\n        dialogOptions.buttons.push({\n          text: options.back,\n          click() {\n            $(this).dialog('close');\n            reject('back');\n          },\n        });\n      }\n      if (options.yes) {\n        dialogOptions.buttons.push({\n          text: options.yes,\n          click() {\n            $(this).dialog('close');\n            resolve(true);\n          },\n        });\n      }\n      dialog\n          .dialog(dialogOptions)\n          .prev('.ui-dialog-titlebar')\n          .css('background', options.color);\n      $(window).on('resize', resizeToFit);\n    });\n  }\n}\n\nwindow.HeadphonesCheck = HeadphonesCheck;"]}